<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Home Server | Jean SEVAUX</title><meta name=keywords content="home-server,home-lab,server,lab,media,download,docker,docker-compose"><meta name=description content="A guide to create your perfect home server."><meta name=author content="Garnajee"><link rel=canonical href=https://garnajee.github.io/posts/home-server/><link crossorigin=anonymous href=/assets/css/stylesheet.856b345dd4348f98bd1658206490a3a0a0b0a89f38f0f5929cfd3ed57ad4e98c.css integrity="sha256-hWs0XdQ0j5i9FlggZJCjoKCwqJ848PWSnP0+1XrU6Yw=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://garnajee.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://garnajee.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://garnajee.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://garnajee.github.io/apple-touch-icon.png><link rel=mask-icon href=https://garnajee.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-C3YDT1E2YB"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-C3YDT1E2YB",{anonymize_ip:!1})}</script><meta property="og:title" content="Home Server"><meta property="og:description" content="A guide to create your perfect home server."><meta property="og:type" content="article"><meta property="og:url" content="https://garnajee.github.io/posts/home-server/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-04-25T10:11:41+02:00"><meta property="article:modified_time" content="2023-04-25T10:11:41+02:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Home Server"><meta name=twitter:description content="A guide to create your perfect home server."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"All posts","item":"https://garnajee.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Home Server","item":"https://garnajee.github.io/posts/home-server/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Home Server","name":"Home Server","description":"A guide to create your perfect home server.","keywords":["home-server","home-lab","server","lab","media","download","docker","docker-compose"],"articleBody":"About In this very complete guide (available here on github), you’ll be able to install from scratch a perfect home-server for a full media donwload and stream automation\nThis is my near-perfect docker-compose for my streaming server.\nYou’ll find two 2 main docker-compose, one to create the streaming services and the other one to access them through a reverse proxy.\nThe only thing to modify is the .env file to suits your setup.\nHere, we are going to install everything under /opt/chill/ (all services for full automation) and /opt/docker/ (reverse proxy).\nTo install everything, just follow this Readme in this order.\nRequirements docker docker-compose a server maybe? I deployed these docker-compose on 2 servers: a Synology DS923+ and a custom server create docker user Synology Server:\nDownload the Docker App available on Synology Package Center Create a docker user once it’s done, connect on SSH and type id and write down the uid and gid respectively PUID and PGID for the .env. Connect on SSH and download docker-compose latest command version: if you are on a system that support apt packages, you can use the compose plugin: apt install docker-compose-plugin (it’s better for updates) check version: $ docker compose version note: with the compose plugin you don’t need the - between docker and compose or you can use the binary: (I use the binary) $ curl -SL https://github.com/docker/compose/releases/download/v2.17.2/docker-compose-linux-x86_64 -o /usr/local/bin/docker-compose # check version $ docker-compose version Medias Server What’s inside This docker-compose contains:\nTransmission-openvpn Jackett FlareSolverr Jellyfin Ombi Radarr Sonarr Removarr Installation Delete previous installation be careful $ rm -rf /opt/chill Create the structure for every services $ mkdir -p /opt/chill/{transovpn/{config,ratio},jackett/config,jellyfin/config,ombi/config,radarr/config,sonarr/config,bazarr/config,storage/downloads/{completed,incomplete,watch,medias/{movies,series}}} Here is what it’s going to create:\nopt └── chill ├── jackett │ └── config ├── jellyfin │ └── config ├── ombi │ └── config ├── radarr │ └── config ├── sonarr │ └── config ├── storage │ └── downloads │ ├── completed │ ├── incomplete │ ├── medias │ │ ├── movies │ │ └── series │ └── watch └── transovpn ├── config └── ratio The /opt/chill/transovpn/ratio/ folder is used to fake your upload stats on (semi-)private indexers. See Fake Ratio.\nThe /opt/chill/storage/downloads/watch/ folder is used when you manually put .torrent files, so it’s going to be downloaded automatically without any access to the Transmission interface.\nTo check everything was properly created $ ls -lR /opt/chill Download the docker-compose-medias.yml and .env-example in /opt/chill/, and rename them:\n$ cd /opt/chill $ wget https://raw.githubusercontent.com/garnajee/home-server/master/docker-compose-medias.yml -O docker-compose.yml $ wget https://raw.githubusercontent.com/garnajee/home-server/master/.env-example -O .env Modify .env Normally, you don’t need to modify the docker-compose.yml file. Only the .env file.\nlist of VPN PROVIDERS local subnet mask for NETWORKIP: ip route | awk '!/ (docker0|br-)/ \u0026\u0026 /src/ {print $1}' PUID and PGID Create a docker network This part is optional. It’s going to be created automatically. But you can still do it manually if you want.\nI did it manually because of the reverse proxy causing errors if I attached it to the automatically created docker subnet.\nAll these images are going to be in the same docker network. To avoid any further conflict, just create it before running the docker-compose.\nHere the subnet is 10.10.66.0/24. If you want to change this by something else, you’ll need to modify the docker-compose.yml too. But remember, it’s just a subnet inside docker, it’s not going to affect your local network.\n$ docker network rm net-chill $ docker network create net-chill -d bridge --subnet 10.10.66.0/24 Run! For the first execution of the docker-compose, I recommend to use this command, to check if there is no errors:\nMove the docker-compose.yml and .env file in /opt/chill/.\n$ cd /opt/chill/ $ docker-compose up It’s going to download all the images, and start all the services.\nBy the way, each request made by Jackett and FlareSolverr goes through the VPN.\nNow, if you don’t see any red lines among the hundreds of lines that have just scrolled through the terminal, it’s usually a good sign.\nSo you can now stop this by pressing CTRL+c (one or two times to force stop), and then run the docker-compose again, but in background this time:\n$ cd /opt/chill/ $ docker-compose up -d Check the status of each docker:\n$ docker ps -a Status should be Up.\nCheck VPN connection Now everything is up, just to be sure, you can check if Transmission goes through VPN:\n$ docker exec -it transovpn curl ifconfig.co XXX.XXX.XXX.XXX And then check the location of this ip address here.\nUpdate docker’s images Update one specific image To update one specific docker image:\n$ cd /opt/chill $ docker-compose stop $ docker-compose rm $ docker-compose pull $ docker-compose up -d Update all images To update all images:\n$ docker-compose down $ docker-compose pull $ docker-compose up -d Access services To access services: (IP is the ip of your server)\nService Address Transmission-openvpn :8000 Jackett :8001 FlareSolverr :8002 Jellyfin :8003 Ombi :8004 Radarr :8010 Sonarr :8011 Removarr :8012 Reverse Proxy To access Jellyfin and Ombi from outside your local network, you’ll need to set up a reverse proxy.\nFor that purpose, I’m going to use Nginx Proxy Manager.\nYou also need to open 2 ports on your router:\nApplication/Service Internal Port External Port Protocol Equipment HTTP 8080 80 TCP/UDP Your-Server HTTPS 4443 443 TCP/UDP Your-Server What’s inside This docker-compose contains:\nNginx Proxy Manager Maria DB Aria Installation Create the directory structure $ mkdir -p /opt/docker/{nginx-proxy-manager,npm-db} Download the docker-compose-rp.yml in /opt/docker/, and rename it:\n$ cd /opt/docker $ wget https://raw.githubusercontent.com/garnajee/home-server/master/docker-compose-rp.yml -O docker-compose.yml I didn’t create a .env file for this docker-compose mainly as this service is not going to be exposed on the web.\nFeel free to modify user, password, name, and so on directly in the docker-compose.yml.\nRun Simply execute this:\n$ cd /opt/docker/ $ docker-compose up Again, it’s going to download the docker images. Check if there is no error, and if it’s good, hit CTRL+c to stop everything and run this command:\n$ docker-compose up -d The service will be accessible at: :81.\nThe default Admin User is:\nemail: admin@example.com password: changeme You’ll be ask to change these informations after the first logging.\nGet a domain name \u0026 SSL certificate I bought a domain name from OVH. If you do the same, follow this:\ncreate an account on OVH buy a domain name once your domain name has been activated, create the necessary token for SSL use this link Make sure to write everything You’ll need something like this:\ndns_ovh_endpoint = ovh-eu dns_ovh_application_key = 109XXX7595XXXXXa dns_ovh_application_secret = a1z2g3y435TGcazbXXXXXXXXa45e dns_ovh_consumer_key = agf6hU1g13uj86XXXXXXXXXfv1l2n3g4j To create your certificate, go back on NPM (:81), “SSL Certificates” tab, “Add …” fill the information for: *.yourdomain.com and yourdomain.com Setup all the services Transmission Nothing to setup or maybe the “Speed Limits” depending on your internet connection.\nJackett Check the box:\nExternal access Cache enabled (recommended) Add these values:\n“Cache TTL (seconds):” 2100 “Cache max results per indexer:” 1000 “FlareSolverr API URL:” http://10.10.66.102:8191 # if you don’t change anything on the docker-compose, that’s it “FlareSolverr Max Timeout (ms):” 100000 Leave the rest blank.\nAdd your indexer(s).\nRadarr \u0026 Sonarr Follow these guides.\nI’ll add more information later.\nJellyfin Follow the steps, it’s easy.\nCreate an API key for Ombi.\nCreate all the users who are going to access to Jellyfin and Ombi.\nTo have better images for your libraires, you can use these images.\nOmbi In the setting page:\n“Configuration” tab: (General) base URL: /ombi (User Management) check the box. It means, that the Jellyfin account (user/password) is the same for Ombi. “Media Server” tab: Hostname/IP: put the internal docker ip: 10.10.66.103. Port: 8096 API key: the one you created just before then load libraries, submit. Now for every service you’re going to add (Sonarr, Radarr, …) make sure to write the internal docker ip address and internal port of the application. The API keys are available in Sonarr/Radarr/… settings tab.\nBonus Don’t want to use a reverse proxy?\nYou can use a VPN:\nOfficial Synology VPN package -\u003e need to open port on your router And if you don’t want to open port on your router (or if you can’t):\nTailscale on Synology CloudFlare Tunnel Pay attention to not use CloudFlare tunnel for Jellyfin streaming, you may be banned for breaking TOS term 2.8.\nWebhooks I provide some webhooks for Jellyfin. These webhooks are used for:\nDiscord Microsoft Teams WhatsApp First of all, you need to install the Jellyfin plugin called “Webhooks”: Jellyfin \u003e Dashboard \u003e Plugins \u003e Catalog \u003e Webhook\nThen, you need to restart Jellyfin:\n$ cd /opt/chill/ $ docker-compose restart jellyfin Now, go back to Jellyfin in the Plugins tab and clic on Webhook.\nThe “Server Url” is your Jellyfin URL. If you expose it on internet, it’s something like this: https://yourdomainname.com/jellyfin\nIf you don’t have a domain name, Jellyfin will not be able to display images (posters) in the Discord/Teams webhooks.\nTo add a Discord webhook:\nclic on “Add Discord Destination” “Webhook Name”: what you want “Webhook Url”: the discord webhook url “Notification type”: if you want to receive notification when a new item (movie/tv show/…) is added, check “Item Added” or when a user is locked out (because of too much wrong password during connection), check “User Locked Out” or when a user is created/deleted, when a password is changed, … (for every use case check this file), check “Authentication *” and “User *” “User Filter”: personnaly, I don’t check anything here “Item Type”: check everything (depending on your webhook template) except “Send All Properties” “Template”: (copy and paste the content) discord-item.handlebars discord-users-locked-out.handlebars discord-users.handlebars “Avatar Url”: just change the avatar profil picture directly on Discord “Webhook Username”: should not be empty, but you can write what you want, the real username is defined directly in Discord “Mention Type”: I never used this “Embed Color”: color of the embeded message Then clic save.\nTo add a Microsoft Teams webhhok:\nclic on “Add a Generic Destination” check the steps for Discord, it’s the same “Template”: “Item Added”: teams-items.handlebars “User Locked Out”: teams-users-locked-out.handlebars “User”: teams-users.handlebars To add a WhatsApp webhook:\nNot as easy as the others.\nYou need to connect you WhatsApp account as if you were logging on WhatsApp Web.\nTo acheive this, you’re going to use another docker-compose to self-host a WhatsApp HTTP API. I’m using this API.\nFollow these steps:\n$ cd /opt/chill $ wget https://raw.githubusercontent.com/garnajee/home-server/master/docker-compose-whatsapp.yml $ docker-compose --file docker-compose-whatsapp.yml up -d Note that the docker-compose I provided is not really optmized, you can add environment variable to better configure. You can check the documentation here.\nFeel free to modify and perhaps make a pull request!\nThen follow the official from step 3 to 5. For any further information, like the id of a contact or a group, please read the documentation.\nGo back to Jellyfin \u003e Plugin \u003e Webhook:\nclic on “Add Generic Form Destination” “Webhook Url”: the internal docker ip, if you don’t change anything in the docker-compose it should be: http://10.10.66.200:3000/api/sendText then check what you want depending on the template Then copy and paste the template you want:\n“Item Added”: whatsapp-items.handlebars (very basic) “User created/deleted”: whatsapp-basic-user.handlebars And finally you need to 2 Headers:\n“Key”: “accept”, “Value”: “application/json” “Key”: “Content-Type”, “Value”: “application/json” Please note, that we cannot send images with this API (it’s a paid feature).\nAnd that’s it, you can save.\nFake Ratio If you need to fake your upload in order to have a ratio \u003e= 1, you can use Ratio.py.\nI don’t recommend using this indefinitely, please consider sharing to the community.\n","wordCount":"1909","inLanguage":"en","datePublished":"2023-04-25T10:11:41+02:00","dateModified":"2023-04-25T10:11:41+02:00","author":{"@type":"Person","name":"Garnajee"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://garnajee.github.io/posts/home-server/"},"publisher":{"@type":"Organization","name":"Jean SEVAUX","logo":{"@type":"ImageObject","url":"https://garnajee.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://garnajee.github.io/ accesskey=h title="Jean SEVAUX (Alt + H)">Jean SEVAUX</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://garnajee.github.io/posts title=Posts><span>Posts</span></a></li><li><a href=https://garnajee.github.io/about title=About><span>About</span></a></li><li><a href=https://garnajee.github.io/contact title=Contact><span>Contact</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://garnajee.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://garnajee.github.io/posts/>All posts</a></div><h1 class=post-title>Home Server<sup><span class=entry-isdraft>&nbsp;&nbsp;[draft]</span></sup></h1><div class=post-meta><span title='2023-04-25 10:11:41 +0200 +0200'>April 25, 2023</span>&nbsp;·&nbsp;9 min&nbsp;·&nbsp;Garnajee</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#about aria-label=About>About</a><ul><li><a href=#requirements aria-label=Requirements>Requirements</a></li><li><a href=#medias-server aria-label="Medias Server">Medias Server</a><ul><li><a href=#whats-inside aria-label="What&amp;rsquo;s inside">What&rsquo;s inside</a></li><li><a href=#installation aria-label=Installation>Installation</a><ul><li><a href=#modify-env aria-label="Modify .env">Modify <code>.env</code></a></li><li><a href=#create-a-docker-network aria-label="Create a docker network">Create a docker network</a></li></ul></li><li><a href=#run aria-label=Run!>Run!</a></li><li><a href=#check-vpn-connection aria-label="Check VPN connection">Check VPN connection</a></li><li><a href=#update-dockers-images aria-label="Update docker&amp;rsquo;s images">Update docker&rsquo;s images</a><ul><li><a href=#update-one-specific-image aria-label="Update one specific image">Update one specific image</a></li><li><a href=#update-all-images aria-label="Update all images">Update all images</a></li></ul></li><li><a href=#access-services aria-label="Access services">Access services</a></li></ul></li><li><a href=#reverse-proxy aria-label="Reverse Proxy">Reverse Proxy</a><ul><li><a href=#whats-inside-1 aria-label="What&amp;rsquo;s inside">What&rsquo;s inside</a></li><li><a href=#installation-1 aria-label=Installation>Installation</a></li><li><a href=#run-1 aria-label=Run>Run</a></li><li><a href=#get-a-domain-name--ssl-certificate aria-label="Get a domain name &amp;amp; SSL certificate">Get a domain name & SSL certificate</a></li></ul></li><li><a href=#setup-all-the-services aria-label="Setup all the services">Setup all the services</a><ul><li><a href=#transmission aria-label=Transmission>Transmission</a></li><li><a href=#jackett aria-label=Jackett>Jackett</a></li><li><a href=#radarr--sonarr aria-label="Radarr &amp;amp; Sonarr">Radarr & Sonarr</a></li><li><a href=#jellyfin aria-label=Jellyfin>Jellyfin</a></li><li><a href=#ombi aria-label=Ombi>Ombi</a></li></ul></li><li><a href=#bonus aria-label=Bonus>Bonus</a><ul><li><a href=#webhooks aria-label=Webhooks>Webhooks</a></li><li><a href=#fake-ratio aria-label="Fake Ratio">Fake Ratio</a></li></ul></li></ul></li></ul></div></details></div><div class=post-content><h1 id=about>About<a hidden class=anchor aria-hidden=true href=#about>#</a></h1><p>In this very complete guide (available <a href=https://github.com/garnajee/home-server/>here on github</a>), you&rsquo;ll be able to install from scratch a perfect home-server for a full media donwload and stream automation</p><p>This is my near-perfect docker-compose for my streaming server.</p><p>You&rsquo;ll find two 2 main docker-compose, one to create the streaming services and the other one to access them through a reverse proxy.</p><p>The only thing to modify is the <code>.env</code> file to suits your setup.</p><p>Here, we are going to install everything under <code>/opt/chill/</code> (all services for full automation) and <code>/opt/docker/</code> (reverse proxy).</p><p>To install everything, just follow this Readme in this order.</p><h2 id=requirements>Requirements<a hidden class=anchor aria-hidden=true href=#requirements>#</a></h2><ul><li><a href=https://docs.docker.com/engine/install/>docker</a></li><li><a href=https://docs.docker.com/compose/install/>docker-compose</a></li><li>a server maybe? I deployed these docker-compose on 2 servers: a Synology DS923+ and a custom server</li><li>create docker <a href=https://docs.docker.com/engine/install/linux-postinstall/>user</a></li></ul><p>Synology Server:</p><ul><li>Download the Docker App available on Synology Package Center</li><li>Create a docker <a href=https://trash-guides.info/Hardlinks/How-to-setup-for/Synology/#create-a-user>user</a><ul><li>once it&rsquo;s done, connect on SSH and type <code>id &lt;username></code> and write down the <code>uid</code> and <code>gid</code> respectively <code>PUID</code> and <code>PGID</code> for the <code>.env</code>.</li></ul></li><li>Connect on SSH and download <code>docker-compose</code> <a href=https://docs.docker.com/compose/install/other/>latest command version</a>:<ul><li>if you are on a system that support <code>apt</code> packages, you can use the <code>compose</code> plugin: <code>apt install docker-compose-plugin</code> (it&rsquo;s better for updates)<ul><li>check version: <code>$ docker compose version</code><ul><li>note: with the <code>compose</code> plugin you don&rsquo;t need the <code>-</code> between <code>docker</code> and <code>compose</code></li></ul></li></ul></li><li>or you can use the binary: (I use the binary)</li></ul></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -SL https://github.com/docker/compose/releases/download/v2.17.2/docker-compose-linux-x86_64 -o /usr/local/bin/docker-compose
</span></span><span style=display:flex><span><span style=color:#75715e># check version</span>
</span></span><span style=display:flex><span>$ docker-compose version
</span></span></code></pre></div><h2 id=medias-server>Medias Server<a hidden class=anchor aria-hidden=true href=#medias-server>#</a></h2><h3 id=whats-inside>What&rsquo;s inside<a hidden class=anchor aria-hidden=true href=#whats-inside>#</a></h3><p>This docker-compose contains:</p><ul><li><a href=https://github.com/haugene/docker-transmission-openvpn>Transmission-openvpn</a></li><li><a href=https://github.com/Jackett/Jackett>Jackett</a></li><li><a href=https://github.com/FlareSolverr/FlareSolverr>FlareSolverr</a></li><li><a href=https://github.com/jellyfin/jellyfin>Jellyfin</a></li><li><a href=https://github.com/Ombi-app/Ombi>Ombi</a></li><li><a href=https://github.com/Radarr/Radarr>Radarr</a></li><li><a href=https://github.com/Sonarr/Sonarr>Sonarr</a></li><li><a href=https://github.com/garnajee/removarr>Removarr</a></li></ul><h3 id=installation>Installation<a hidden class=anchor aria-hidden=true href=#installation>#</a></h3><ul><li>Delete previous installation <strong>be careful</strong></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ rm -rf /opt/chill
</span></span></code></pre></div><ul><li>Create the structure for every services</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ mkdir -p /opt/chill/<span style=color:#f92672>{</span>transovpn/<span style=color:#f92672>{</span>config,ratio<span style=color:#f92672>}</span>,jackett/config,jellyfin/config,ombi/config,radarr/config,sonarr/config,bazarr/config,storage/downloads/<span style=color:#f92672>{</span>completed,incomplete,watch,medias/<span style=color:#f92672>{</span>movies,series<span style=color:#f92672>}}}</span>
</span></span></code></pre></div><p>Here is what it&rsquo;s going to create:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>opt
</span></span><span style=display:flex><span>└── chill
</span></span><span style=display:flex><span>    ├── jackett
</span></span><span style=display:flex><span>    │   └── config
</span></span><span style=display:flex><span>    ├── jellyfin
</span></span><span style=display:flex><span>    │   └── config
</span></span><span style=display:flex><span>    ├── ombi
</span></span><span style=display:flex><span>    │   └── config
</span></span><span style=display:flex><span>    ├── radarr
</span></span><span style=display:flex><span>    │   └── config
</span></span><span style=display:flex><span>    ├── sonarr
</span></span><span style=display:flex><span>    │   └── config
</span></span><span style=display:flex><span>    ├── storage
</span></span><span style=display:flex><span>    │   └── downloads
</span></span><span style=display:flex><span>    │       ├── completed
</span></span><span style=display:flex><span>    │       ├── incomplete
</span></span><span style=display:flex><span>    │       ├── medias
</span></span><span style=display:flex><span>    │       │   ├── movies
</span></span><span style=display:flex><span>    │       │   └── series
</span></span><span style=display:flex><span>    │       └── watch
</span></span><span style=display:flex><span>    └── transovpn
</span></span><span style=display:flex><span>        ├── config
</span></span><span style=display:flex><span>        └── ratio
</span></span></code></pre></div><p>The <code>/opt/chill/transovpn/ratio/</code> folder is used to fake your upload stats on (semi-)private indexers. See <a href=/posts/home-server/#fake-ratio>Fake Ratio</a>.</p><p>The <code>/opt/chill/storage/downloads/watch/</code> folder is used when you manually put <code>.torrent</code> files, so it&rsquo;s going to be downloaded automatically without any access to the Transmission interface.</p><ul><li>To check everything was properly created</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ls -lR /opt/chill
</span></span></code></pre></div><p>Download the <code>docker-compose-medias.yml</code> and <code>.env-example</code> in <code>/opt/chill/</code>, and rename them:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cd /opt/chill
</span></span><span style=display:flex><span>$ wget https://raw.githubusercontent.com/garnajee/home-server/master/docker-compose-medias.yml -O docker-compose.yml
</span></span><span style=display:flex><span>$ wget https://raw.githubusercontent.com/garnajee/home-server/master/.env-example -O .env
</span></span></code></pre></div><h4 id=modify-env>Modify <code>.env</code><a hidden class=anchor aria-hidden=true href=#modify-env>#</a></h4><p>Normally, you don&rsquo;t need to modify the docker-compose.yml file. Only the <code>.env</code> file.</p><ul><li>list of <a href=https://haugene.github.io/docker-transmission-openvpn/supported-providers/>VPN PROVIDERS</a></li><li>local subnet mask for <code>NETWORKIP</code>: <code>ip route | awk '!/ (docker0|br-)/ && /src/ {print $1}'</code></li><li>PUID and PGID</li></ul><h4 id=create-a-docker-network>Create a docker network<a hidden class=anchor aria-hidden=true href=#create-a-docker-network>#</a></h4><p>This part is optional. It&rsquo;s going to be created automatically. But you can still do it manually if you want.</p><p>I did it manually because of the reverse proxy causing errors if I attached it to the automatically created docker subnet.</p><p>All these images are going to be in the same docker network. To avoid any further conflict, just create it before running the docker-compose.</p><p>Here the subnet is <code>10.10.66.0/24</code>. If you want to change this by something else, you&rsquo;ll need to modify the <code>docker-compose.yml</code> too. But remember, it&rsquo;s just a subnet <em>inside</em> docker, it&rsquo;s not going to affect your local network.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ docker network rm net-chill
</span></span><span style=display:flex><span>$ docker network create net-chill -d bridge --subnet 10.10.66.0/24
</span></span></code></pre></div><h3 id=run>Run!<a hidden class=anchor aria-hidden=true href=#run>#</a></h3><p>For the first execution of the docker-compose, I recommend to use this command, to check if there is no errors:</p><p>Move the <code>docker-compose.yml</code> and <code>.env</code> file in <code>/opt/chill/</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cd /opt/chill/
</span></span><span style=display:flex><span>$ docker-compose up
</span></span></code></pre></div><p>It&rsquo;s going to download all the images, and start all the services.</p><p><strong>By the way, each request made by Jackett and FlareSolverr goes through the VPN.</strong></p><p>Now, if you don&rsquo;t see any red lines among the hundreds of lines that have just scrolled through the terminal, it&rsquo;s usually a good sign.</p><p>So you can now stop this by pressing <code>CTRL+c</code> (one or two times to force stop), and then run the docker-compose again, but in background this time:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cd /opt/chill/
</span></span><span style=display:flex><span>$ docker-compose up -d
</span></span></code></pre></div><p>Check the status of each docker:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ docker ps -a
</span></span></code></pre></div><p><code>Status</code> should be <code>Up</code>.</p><h3 id=check-vpn-connection>Check VPN connection<a hidden class=anchor aria-hidden=true href=#check-vpn-connection>#</a></h3><p>Now everything is up, just to be sure, you can check if Transmission goes through VPN:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ docker exec -it transovpn curl ifconfig.co
</span></span><span style=display:flex><span>XXX.XXX.XXX.XXX
</span></span></code></pre></div><p>And then check the location of this ip address <a href=https://ifconfig.co>here</a>.</p><h3 id=update-dockers-images>Update docker&rsquo;s images<a hidden class=anchor aria-hidden=true href=#update-dockers-images>#</a></h3><h4 id=update-one-specific-image>Update one specific image<a hidden class=anchor aria-hidden=true href=#update-one-specific-image>#</a></h4><p>To update one specific docker image:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cd /opt/chill
</span></span><span style=display:flex><span>$ docker-compose stop &lt;container_name&gt;
</span></span><span style=display:flex><span>$ docker-compose rm &lt;container_name&gt;
</span></span><span style=display:flex><span>$ docker-compose pull &lt;container_name&gt;
</span></span><span style=display:flex><span>$ docker-compose up -d
</span></span></code></pre></div><h4 id=update-all-images>Update all images<a hidden class=anchor aria-hidden=true href=#update-all-images>#</a></h4><p>To update all images:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ docker-compose down
</span></span><span style=display:flex><span>$ docker-compose pull
</span></span><span style=display:flex><span>$ docker-compose up -d
</span></span></code></pre></div><h3 id=access-services>Access services<a hidden class=anchor aria-hidden=true href=#access-services>#</a></h3><p>To access services: (<code>IP</code> is the ip of your server)</p><table><thead><tr><th><strong>Service</strong></th><th><strong>Address</strong></th></tr></thead><tbody><tr><td>Transmission-openvpn</td><td><code>&lt;IP>:8000</code></td></tr><tr><td>Jackett</td><td><code>&lt;IP>:8001</code></td></tr><tr><td>FlareSolverr</td><td><code>&lt;IP>:8002</code></td></tr><tr><td>Jellyfin</td><td><code>&lt;IP>:8003</code></td></tr><tr><td>Ombi</td><td><code>&lt;IP>:8004</code></td></tr><tr><td>Radarr</td><td><code>&lt;IP>:8010</code></td></tr><tr><td>Sonarr</td><td><code>&lt;IP>:8011</code></td></tr><tr><td>Removarr</td><td><code>&lt;IP>:8012</code></td></tr></tbody></table><h2 id=reverse-proxy>Reverse Proxy<a hidden class=anchor aria-hidden=true href=#reverse-proxy>#</a></h2><p>To access Jellyfin and Ombi from outside your local network, you&rsquo;ll need to set up a reverse proxy.</p><p>For that purpose, I&rsquo;m going to use <a href=https://nginxproxymanager.com/setup/>Nginx Proxy Manager</a>.</p><p>You also need to open 2 ports on your router:</p><table><thead><tr><th>Application/Service</th><th>Internal Port</th><th>External Port</th><th>Protocol</th><th>Equipment</th></tr></thead><tbody><tr><td>HTTP</td><td>8080</td><td>80</td><td>TCP/UDP</td><td>Your-Server</td></tr><tr><td>HTTPS</td><td>4443</td><td>443</td><td>TCP/UDP</td><td>Your-Server</td></tr></tbody></table><h3 id=whats-inside-1>What&rsquo;s inside<a hidden class=anchor aria-hidden=true href=#whats-inside-1>#</a></h3><p>This docker-compose contains:</p><ul><li><a href=https://github.com/NginxProxyManager/nginx-proxy-manager>Nginx Proxy Manager</a></li><li><a href=https://github.com/jc21/docker-mariadb-aria>Maria DB Aria</a></li></ul><h3 id=installation-1>Installation<a hidden class=anchor aria-hidden=true href=#installation-1>#</a></h3><ul><li>Create the directory structure</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ mkdir -p /opt/docker/<span style=color:#f92672>{</span>nginx-proxy-manager,npm-db<span style=color:#f92672>}</span>
</span></span></code></pre></div><p>Download the <code>docker-compose-rp.yml</code> in <code>/opt/docker/</code>, and rename it:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cd /opt/docker
</span></span><span style=display:flex><span>$ wget https://raw.githubusercontent.com/garnajee/home-server/master/docker-compose-rp.yml -O docker-compose.yml
</span></span></code></pre></div><p>I didn&rsquo;t create a <code>.env</code> file for this docker-compose mainly as this service is not going to be exposed on the web.</p><p>Feel free to modify <code>user</code>, <code>password</code>, <code>name</code>, and so on directly in the <code>docker-compose.yml</code>.</p><h3 id=run-1>Run<a hidden class=anchor aria-hidden=true href=#run-1>#</a></h3><p>Simply execute this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cd /opt/docker/
</span></span><span style=display:flex><span>$ docker-compose up
</span></span></code></pre></div><p>Again, it&rsquo;s going to download the docker images. Check if there is no error, and if it&rsquo;s good, hit <code>CTRL+c</code> to stop everything and run this command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ docker-compose up -d
</span></span></code></pre></div><p>The service will be accessible at: <code>&lt;IP>:81</code>.</p><p>The default Admin User is:</p><pre tabindex=0><code>email: admin@example.com
password: changeme
</code></pre><p>You&rsquo;ll be ask to change these informations after the first logging.</p><h3 id=get-a-domain-name--ssl-certificate>Get a domain name & SSL certificate<a hidden class=anchor aria-hidden=true href=#get-a-domain-name--ssl-certificate>#</a></h3><p>I bought a domain name from OVH. If you do the same, follow this:</p><ul><li>create an account on <a href=https://ovh.com>OVH</a></li><li>buy a domain name</li><li>once your domain name has been activated, create the necessary token for SSL</li><li>use this <a href="https://www.ovh.com/auth/api/createToken?GET=/domain/zone/*&amp;POST=/domain/zone/*&amp;PUT=/domain/zone/*&amp;DELETE=/domain/zone/*">link</a></li><li><strong>Make sure to write everything</strong></li></ul><p>You&rsquo;ll need something like this:</p><pre tabindex=0><code>dns_ovh_endpoint = ovh-eu
dns_ovh_application_key = 109XXX7595XXXXXa
dns_ovh_application_secret = a1z2g3y435TGcazbXXXXXXXXa45e
dns_ovh_consumer_key = agf6hU1g13uj86XXXXXXXXXfv1l2n3g4j
</code></pre><ul><li>To create your certificate, go back on NPM (<code>&lt;IP>:81</code>), &ldquo;SSL Certificates&rdquo; tab, &ldquo;Add &mldr;&rdquo;</li><li>fill the information for: <code>*.yourdomain.com</code> and <code>yourdomain.com</code></li></ul><h2 id=setup-all-the-services>Setup all the services<a hidden class=anchor aria-hidden=true href=#setup-all-the-services>#</a></h2><h3 id=transmission>Transmission<a hidden class=anchor aria-hidden=true href=#transmission>#</a></h3><p>Nothing to setup or maybe the &ldquo;Speed Limits&rdquo; depending on your internet connection.</p><h3 id=jackett>Jackett<a hidden class=anchor aria-hidden=true href=#jackett>#</a></h3><p>Check the box:</p><ul><li>External access</li><li>Cache enabled (recommended)</li></ul><p>Add these values:</p><ul><li>&ldquo;Cache TTL (seconds):&rdquo; <code>2100</code></li><li>&ldquo;Cache max results per indexer:&rdquo; <code>1000</code></li><li>&ldquo;FlareSolverr API URL:&rdquo; <code>http://10.10.66.102:8191</code> # <strong>if you don&rsquo;t change anything on the docker-compose, that&rsquo;s it</strong></li><li>&ldquo;FlareSolverr Max Timeout (ms):&rdquo; <code>100000</code></li></ul><p>Leave the rest blank.</p><p>Add your indexer(s).</p><h3 id=radarr--sonarr>Radarr & Sonarr<a hidden class=anchor aria-hidden=true href=#radarr--sonarr>#</a></h3><p>Follow these <a href=https://trash-guides.info/>guides</a>.</p><p>I&rsquo;ll add more information later.</p><h3 id=jellyfin>Jellyfin<a hidden class=anchor aria-hidden=true href=#jellyfin>#</a></h3><p>Follow the steps, it&rsquo;s easy.</p><p>Create an API key for Ombi.</p><p>Create all the users who are going to access to Jellyfin <strong>and</strong> Ombi.</p><p>To have better images for your libraires, you can use <a href=https://imgur.com/a/Guqk15B>these images</a>.</p><h3 id=ombi>Ombi<a hidden class=anchor aria-hidden=true href=#ombi>#</a></h3><p>In the setting page:</p><ul><li>&ldquo;Configuration&rdquo; tab:<ul><li>(General) base URL: <code>/ombi</code></li><li>(User Management) check the box. It means, that the Jellyfin account (user/password) is the same for Ombi.</li></ul></li><li>&ldquo;Media Server&rdquo; tab:<ul><li>Hostname/IP: put the internal docker ip: <code>10.10.66.103</code>.</li><li>Port: <code>8096</code></li><li>API key: the one you created just before</li><li>then load libraries, submit.</li></ul></li></ul><p>Now for every service you&rsquo;re going to add (Sonarr, Radarr, &mldr;) make sure to write the <em>internal docker ip address and internal port of the application</em>. The API keys are available in Sonarr/Radarr/&mldr; settings tab.</p><h2 id=bonus>Bonus<a hidden class=anchor aria-hidden=true href=#bonus>#</a></h2><p>Don&rsquo;t want to use a reverse proxy?</p><p>You can use a VPN:</p><ul><li>Official Synology VPN package -> <em>need to open port on your router</em></li></ul><p>And if you don&rsquo;t want to open port on your router (or if you can&rsquo;t):</p><ul><li><a href=https://tailscale.com/kb/1131/synology/>Tailscale</a> on Synology</li><li><a href=https://github.com/cloudflare/cloudflared>CloudFlare Tunnel</a></li></ul><p>Pay attention to not use CloudFlare tunnel for Jellyfin streaming, you may be banned for breaking TOS <a href=https://www.cloudflare.com/en-gb/terms/>term 2.8</a>.</p><h3 id=webhooks>Webhooks<a hidden class=anchor aria-hidden=true href=#webhooks>#</a></h3><p>I provide some webhooks for Jellyfin. These webhooks are used for:</p><ul><li>Discord</li><li>Microsoft Teams</li><li>WhatsApp</li></ul><p>First of all, you need to install the Jellyfin plugin called &ldquo;Webhooks&rdquo;: Jellyfin > Dashboard > Plugins > Catalog > Webhook</p><p>Then, you need to restart Jellyfin:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cd /opt/chill/
</span></span><span style=display:flex><span>$ docker-compose restart jellyfin
</span></span></code></pre></div><p>Now, go back to Jellyfin in the Plugins tab and clic on Webhook.</p><p>The &ldquo;<em>Server Url</em>&rdquo; is your Jellyfin URL. If you expose it on internet, it&rsquo;s something like this: <a href=https://yourdomainname.com/jellyfin>https://yourdomainname.com/jellyfin</a></p><p><em>If you don&rsquo;t have a domain name, Jellyfin will not be able to display images (posters) in the Discord/Teams webhooks.</em></p><p>To add a <strong>Discord</strong> webhook:</p><ul><li>clic on &ldquo;Add Discord Destination&rdquo;</li><li>&ldquo;<em>Webhook Name</em>&rdquo;: what you want</li><li>&ldquo;<em>Webhook Url</em>&rdquo;: the discord webhook url</li><li>&ldquo;<em>Notification type</em>&rdquo;:<ol><li>if you want to receive notification when a new item (movie/tv show/&mldr;) is added, check &ldquo;<em>Item Added</em>&rdquo;</li><li>or when a user is locked out (because of too much wrong password during connection), check &ldquo;<em>User Locked Out</em>&rdquo;</li><li>or when a user is created/deleted, when a password is changed, &mldr; (for every use case check <a href=https://github.com/garnajee/home-server/blob/master/webhooks/jellyfin/discord/discord-users.handlebars>this file</a>), check &ldquo;<em>Authentication *</em>&rdquo; and &ldquo;<em>User *</em>&rdquo;</li></ol></li><li>&ldquo;<em>User Filter</em>&rdquo;: personnaly, I don&rsquo;t check anything here</li><li>&ldquo;<em>Item Type</em>&rdquo;: check everything (depending on your webhook template) <strong>except</strong> &ldquo;<em>Send All Properties</em>&rdquo;</li><li>&ldquo;<em>Template</em>&rdquo;: (copy and paste the content)<ol><li><a href=https://github.com/garnajee/home-server/blob/master/webhooks/jellyfin/discord/discord-item.handlebars>discord-item.handlebars</a></li><li><a href=https://github.com/garnajee/home-server/blob/master/webhooks/jellyfin/discord/discord-users-locked-out.handlebars>discord-users-locked-out.handlebars</a></li><li><a href=https://github.com/garnajee/home-server/blob/master/webhooks/jellyfin/discord/discord-users.handlebars>discord-users.handlebars</a></li></ol></li><li>&ldquo;<em>Avatar Url</em>&rdquo;: just change the avatar profil picture directly on Discord</li><li>&ldquo;<em>Webhook Username</em>&rdquo;: should not be empty, but you can write what you want, the real username is defined directly in Discord</li><li>&ldquo;<em>Mention Type</em>&rdquo;: I never used this</li><li>&ldquo;<em>Embed Color</em>&rdquo;: color of the embeded message</li></ul><p>Then clic save.</p><p>To add a <strong>Microsoft Teams</strong> webhhok:</p><ul><li>clic on &ldquo;Add a Generic Destination&rdquo;</li><li>check the steps for Discord, it&rsquo;s the same</li><li>&ldquo;<em>Template</em>&rdquo;:<ol><li>&ldquo;<em>Item Added</em>&rdquo;: <a href=https://github.com/garnajee/home-server/blob/master/webhooks/jellyfin/ms-teams/teams-items.handlebars>teams-items.handlebars</a></li><li>&ldquo;<em>User Locked Out</em>&rdquo;: <a href=https://github.com/garnajee/home-server/blob/master/webhooks/jellyfin/ms-teams/teams-users-locked-out.handlebars>teams-users-locked-out.handlebars</a></li><li>&ldquo;<em>User</em>&rdquo;: <a href=https://github.com/garnajee/home-server/blob/master/webhooks/jellyfin/ms-teams/teams-users.handlebars>teams-users.handlebars</a></li></ol></li></ul><p>To add a <strong>WhatsApp</strong> webhook:</p><p>Not as easy as the others.</p><p>You need to connect you WhatsApp account as if you were logging on WhatsApp Web.</p><p>To acheive this, you&rsquo;re going to use another docker-compose to self-host a WhatsApp HTTP API. I&rsquo;m using <a href=https://github.com/devlikeapro/whatsapp-http-api>this API</a>.</p><p>Follow these steps:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cd /opt/chill
</span></span><span style=display:flex><span>$ wget https://raw.githubusercontent.com/garnajee/home-server/master/docker-compose-whatsapp.yml
</span></span><span style=display:flex><span>$ docker-compose --file docker-compose-whatsapp.yml up -d
</span></span></code></pre></div><blockquote><p>Note that the docker-compose I provided is not really optmized, you can add environment variable to better configure. You can check the documentation <a href=https://waha.devlike.pro/docs/how-to/config/>here</a>.</p></blockquote><blockquote><p><strong>Feel free to modify and perhaps make a pull request!</strong></p></blockquote><p>Then follow the <a href=https://github.com/devlikeapro/whatsapp-http-api#3-start-a-new-session>official</a> from step <strong>3</strong> to <strong>5</strong>. For any further information, like the id of a contact or a group, please read the <a href=https://waha.devlike.pro/docs/how-to/>documentation</a>.</p><p>Go back to Jellyfin > Plugin > Webhook:</p><ul><li>clic on &ldquo;Add Generic Form Destination&rdquo;</li><li>&ldquo;<em>Webhook Url</em>&rdquo;: the <strong>internal</strong> docker ip, if you don&rsquo;t change anything in the docker-compose it should be: <code>http://10.10.66.200:3000/api/sendText</code></li><li>then check what you want depending on the template</li></ul><p>Then copy and paste the template you want:</p><ol><li>&ldquo;<em>Item Added</em>&rdquo;: <a href=https://github.com/garnajee/home-server/blob/master/webhooks/jellyfin/whatsapp/whatsapp-items.handlebars>whatsapp-items.handlebars</a></li><li>(very basic) &ldquo;<em>User created/deleted</em>&rdquo;: <a href=https://github.com/garnajee/home-server/blob/master/webhooks/jellyfin/whatsapp/whatsapp-basic-user.handlebars>whatsapp-basic-user.handlebars</a></li></ol><p>And finally you need to 2 Headers:</p><ol><li>&ldquo;<em>Key</em>&rdquo;: &ldquo;accept&rdquo;, &ldquo;<em>Value</em>&rdquo;: &ldquo;application/json&rdquo;</li><li>&ldquo;<em>Key</em>&rdquo;: &ldquo;Content-Type&rdquo;, &ldquo;<em>Value</em>&rdquo;: &ldquo;application/json&rdquo;</li></ol><blockquote><p>Please note, that we cannot send images with this API (it&rsquo;s a paid feature).</p></blockquote><p>And that&rsquo;s it, you can save.</p><h3 id=fake-ratio>Fake Ratio<a hidden class=anchor aria-hidden=true href=#fake-ratio>#</a></h3><p>If you need to fake your upload in order to have a ratio >= 1, you can use <a href=https://github.com/garnajee/Ratio.py>Ratio.py</a>.</p><p>I don&rsquo;t recommend using this indefinitely, please consider sharing to the community.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://garnajee.github.io/tags/home-server/>home-server</a></li><li><a href=https://garnajee.github.io/tags/home-lab/>home-lab</a></li><li><a href=https://garnajee.github.io/tags/server/>server</a></li><li><a href=https://garnajee.github.io/tags/lab/>lab</a></li><li><a href=https://garnajee.github.io/tags/media/>media</a></li><li><a href=https://garnajee.github.io/tags/download/>download</a></li><li><a href=https://garnajee.github.io/tags/docker/>docker</a></li><li><a href=https://garnajee.github.io/tags/docker-compose/>docker-compose</a></li></ul><nav class=paginav><a class=prev href=https://garnajee.github.io/posts/removarr/><span class=title>« Prev</span><br><span>Removarr</span></a>
<a class=next href=https://garnajee.github.io/posts/settings/><span class=title>Next »</span><br><span>My Settings</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://garnajee.github.io/>Jean SEVAUX</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>